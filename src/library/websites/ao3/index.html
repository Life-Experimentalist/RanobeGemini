<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Archive of Our Own - Novel Library</title>
		<link rel="stylesheet" href="../shelf-page.css" />
		<link
			rel="icon"
			type="image/png"
			sizes="32x32"
			href="../../../icons/icon.png"
		/>
	</head>
	<body class="ao3-page">
		<div class="shelf-page-container">
			<!-- Page Header -->
			<header class="shelf-page-header">
				<div class="shelf-page-title">
					<span
						class="shelf-page-color-bar"
						id="color-bar"
						style="background: #990000"
					></span>
					<img
						src="https://archiveofourown.org/images/ao3_logos/logo_42.png"
						alt="Archive of Our Own"
						class="shelf-page-icon-img"
						id="page-icon-img"
						onerror="this.style.display='none'; document.getElementById('page-icon').style.display='inline';"
					/>
					<span
						class="shelf-page-icon"
						id="page-icon"
						style="display: none"
						>üèõÔ∏è</span
					>
					<h1 id="page-title">Archive of Our Own</h1>
					<span class="novel-count" id="novel-count">(0 works)</span>
				</div>
				<a href="../../library.html" class="back-link">
					‚Üê Back to Library
				</a>
			</header>

			<!-- Analytics Section -->
			<div class="analytics-section" id="analytics-section">
				<div class="analytics-grid">
					<!-- Stats Summary -->
					<div class="stats-summary">
						<div class="stat-card">
							<span class="stat-value" id="stats-novels">0</span>
							<span class="stat-label">Works</span>
						</div>
						<div class="stat-card">
							<span class="stat-value" id="stats-enhanced">0</span>
							<span class="stat-label">Enhanced Chapters</span>
						</div>
						<div class="stat-card">
							<span class="stat-value" id="stats-words">0</span>
							<span class="stat-label">Total Words</span>
						</div>
						<div class="stat-card">
							<span class="stat-value" id="stats-completed">0</span>
							<span class="stat-label">Completed Works</span>
						</div>
						<div class="stat-card">
							<span class="stat-value" id="stats-kudos">0</span>
							<span class="stat-label">Total Kudos</span>
						</div>
						<div class="stat-card">
							<span class="stat-value" id="stats-hits">0</span>
							<span class="stat-label">Total Hits</span>
						</div>
						<div class="stat-card">
							<span class="stat-value" id="stats-avgrating">-</span>
							<span class="stat-label">Avg Rating</span>
						</div>
						<div class="stat-card">
							<span class="stat-value" id="stats-reading">0%</span>
							<span class="stat-label">Reading</span>
						</div>
					</div>

					<!-- Detail Analytics -->
					<div class="detail-analytics">
						<h3>Library Insights</h3>
						<div class="analytics-items">
							<div class="analytics-item">
								<span class="analytics-icon">‚ù§Ô∏è</span>
								<div class="analytics-detail">
									<span class="analytics-label">Most Kudos</span>
									<span class="analytics-value" id="most-kudos">-</span>
								</div>
							</div>
							<div class="analytics-item">
								<span class="analytics-icon">üëÅÔ∏è</span>
								<div class="analytics-detail">
									<span class="analytics-label">Most Hits</span>
									<span class="analytics-value" id="most-hits">-</span>
								</div>
							</div>
							<div class="analytics-item">
								<span class="analytics-icon">üí¨</span>
								<div class="analytics-detail">
									<span class="analytics-label">Most Comments</span>
									<span class="analytics-value" id="most-comments">-</span>
								</div>
							</div>
							<div class="analytics-item">
								<span class="analytics-icon">üìè</span>
								<div class="analytics-detail">
									<span class="analytics-label">Longest Work</span>
									<span class="analytics-value" id="longest-work">-</span>
								</div>
							</div>
							<div class="analytics-item">
								<span class="analytics-icon">üÜï</span>
								<div class="analytics-detail">
									<span class="analytics-label">Newest Addition</span>
									<span class="analytics-value" id="newest-addition">-</span>
								</div>
							</div>
							<div class="analytics-item">
								<span class="analytics-icon">üìö</span>
								<div class="analytics-detail">
									<span class="analytics-label">Most Chapters</span>
									<span class="analytics-value" id="most-chapters">-</span>
								</div>
							</div>
						</div>
						<div class="analytics-chart" id="status-chart-card">
							<div class="chart-header">
								<h4>Reading Status Mix</h4>
								<span class="chart-summary" id="status-chart-summary">-</span>
							</div>
							<div class="bar-chart" id="reading-status-chart"></div>
							<div class="bar-chart-legend" id="reading-status-legend"></div>
						</div>
					</div>
				</div>
			</div>

			<!-- Filters Section - Compact Design -->
			<div class="filters-section">
				<div class="filter-dropdown-container">
					<button class="filter-toggle-btn" id="filter-toggle-btn">
						‚öôÔ∏è Filters
						<span class="filter-badge" id="filter-badge" style="display: none">‚úì</span>
					</button>
					<div class="active-filters" id="active-filters"></div>

					<div class="filter-dropdown" id="filter-dropdown" style="display: none">
						<div class="filter-grid">
							<!-- Sorting & Basics -->
							<div class="filter-item">
								<label for="sort-select">Sort by:</label>
								<select id="sort-select">
									<option value="recent">Recently Read</option>
									<option value="added">Date Added</option>
									<option value="title">Title</option>
									<option value="chapters">Enhanced Chapters</option>
									<option value="words">Word Count</option>
									<option value="kudos">Kudos</option>
									<option value="hits">Hits</option>
									<option value="comments">Comments</option>
									<option value="bookmarks">Bookmarks</option>
									<option value="published">Published Date</option>
									<option value="updated">Updated Date</option>
									<option value="status">Work Status</option>
								</select>
							</div>

							<div class="filter-item">
								<label for="rating-filter">Rating:</label>
								<select id="rating-filter">
									<option value="all">All Ratings</option>
									<option value="General Audiences">General Audiences</option>
									<option value="Teen And Up Audiences">Teen And Up</option>
									<option value="Mature">Mature</option>
									<option value="Explicit">Explicit</option>
									<option value="Not Rated">Not Rated</option>
								</select>
							</div>

							<div class="filter-item">
								<label for="work-status-filter">Work Status:</label>
								<select id="work-status-filter">
									<option value="all">All</option>
									<option value="completed">Completed</option>
									<option value="ongoing">Work in Progress</option>
								</select>
							</div>

							<div class="filter-item">
								<label for="status-filter">Reading Status:</label>
								<select id="status-filter">
									<option value="all">All</option>
									<option value="plan-to-read">Plan to Read</option>
									<option value="reading">Currently Reading</option>
									<option value="completed">Completed</option>
									<option value="on-hold">On Hold</option>
									<option value="dropped">Dropped</option>
									<option value="re-reading">Re-reading</option>
								</select>
							</div>

							<div class="filter-item">
								<label for="category-filter">Category:</label>
								<select id="category-filter">
									<option value="all">All Categories</option>
									<option value="F/F">F/F</option>
									<option value="F/M">F/M</option>
									<option value="M/M">M/M</option>
									<option value="Gen">Gen</option>
									<option value="Multi">Multi</option>
									<option value="Other">Other</option>
								</select>
							</div>

							<div class="filter-item">
								<label for="language-filter">Language:</label>
								<select id="language-filter">
									<option value="all">All Languages</option>
								</select>
							</div>

							<div class="filter-item">
								<label>Fandoms (max 2):</label>
								<div class="multi-dropdown">
									<button type="button" class="multi-dropdown-toggle" id="fandoms-dropdown-toggle">Choose Fandoms</button>
									<div class="multi-dropdown-panel" id="fandoms-dropdown-panel">
										<div class="filter-pill-list" id="fandoms-filter"></div>
									</div>
								</div>
							</div>

							<div class="filter-item">
								<label>Relationships:</label>
								<div class="multi-dropdown">
									<button type="button" class="multi-dropdown-toggle" id="relationships-dropdown-toggle">Choose Relationships</button>
									<div class="multi-dropdown-panel" id="relationships-dropdown-panel">
										<div class="filter-pill-list" id="relationships-filter"></div>
									</div>
								</div>
							</div>

							<div class="filter-item">
								<label>Characters (max 4):</label>
								<div class="multi-dropdown">
									<button type="button" class="multi-dropdown-toggle" id="characters-dropdown-toggle">Choose Characters</button>
									<div class="multi-dropdown-panel" id="characters-dropdown-panel">
										<div class="filter-pill-list" id="characters-filter"></div>
									</div>
								</div>
							</div>

							<div class="filter-item">
								<label>Additional Tags:</label>
								<div class="multi-dropdown">
									<div class="tag-match-row">
										<label for="tags-match-mode" class="tag-match-label">Match:</label>
										<select id="tags-match-mode" class="tag-match-select">
											<option value="any">Any tag (OR)</option>
											<option value="all">All tags (AND)</option>
										</select>
									</div>
									<button type="button" class="multi-dropdown-toggle" id="tags-dropdown-toggle">Choose Tags</button>
									<div class="multi-dropdown-panel" id="tags-dropdown-panel">
										<div class="filter-pill-list" id="tags-filter"></div>
									</div>
								</div>
							</div>

							<div class="filter-item full-width">
								<label>Word Count Range:</label>
								<div class="wordcount-row">
									<input type="number" id="wordcount-min" placeholder="Min" min="0" />
									<span class="range-separator">to</span>
									<input type="number" id="wordcount-max" placeholder="Max" min="0" />
								</div>
								<p class="filter-hint">Leave blank for no limit</p>
							</div>

							<div class="filter-item full-width">
								<button class="clear-filters-btn" id="clear-filters-btn">
									Clear All Filters
								</button>
							</div>
						</div>
					</div>
				</div>

				<div class="search-bar-container search-right">
					<input
						type="text"
						id="search-input"
						class="search-bar"
						placeholder="üîç Search by title or author..."
					/>
				</div>
			</div>

			<!-- Category Navigation for Fandoms -->
			<div class="category-section" id="category-section" style="display: none">
				<div class="category-header">
					<h3 id="category-title">Browse by Fandom</h3>
					<button id="back-to-all" class="back-btn" style="display: none">
						‚Üê Back to All
					</button>
				</div>
				<div class="category-grid" id="category-grid"></div>
			</div>

			<!-- Loading State -->
			<div class="loading-state" id="loading-state">
				<div class="loading-spinner"></div>
				<p>Loading works...</p>
			</div>

			<!-- Empty State -->
			<div class="empty-state" id="empty-state" style="display: none">
				<span class="empty-icon">üèõÔ∏è</span>
				<h2>No works from AO3 yet!</h2>
				<p>
					Visit a chapter on
					<a href="https://archiveofourown.org" target="_blank">archiveofourown.org</a>
					to add works to your library
				</p>
			</div>

			<!-- Novel Grid -->
			<div class="novel-grid" id="novel-grid" style="display: none"></div>
		</div>

		<!-- Novel Detail Modal -->
		<div class="modal" id="novel-modal" style="display: none">
			<div class="modal-backdrop" id="modal-backdrop"></div>
			<div class="modal-content ao3-modal-content">
				<div class="modal-header ao3-modal-header">
					<div class="modal-title-section">
						<div class="modal-cover-container" id="modal-cover-container">
							<!-- Placeholder will be inserted here by JS -->
						</div>
						<div class="modal-header-text">
							<h2 id="modal-title"></h2>
							<p id="modal-author"></p>
							<p id="modal-description" class="modal-description"></p>
						</div>
					</div>
					<button class="modal-close" id="modal-close-btn">&times;</button>
				</div>
				<div class="modal-body">
					<div id="modal-metadata-container"></div>
				</div>
				<div class="modal-footer">
					<div class="modal-status-section">
						<div class="status-label">Reading Status:</div>
						<div class="status-buttons">
							<button class="status-btn" data-status="plan-to-read" title="Plan to Read">üìã To Read</button>
							<button class="status-btn" data-status="reading" title="Currently Reading">üìñ Reading</button>
							<button class="status-btn" data-status="completed" title="Completed">‚úÖ Completed</button>
							<button class="status-btn" data-status="on-hold" title="On Hold">‚è∏Ô∏è On Hold</button>
							<button class="status-btn" data-status="dropped" title="Dropped">‚ùå Dropped</button>
							<button class="status-btn" data-status="rereading" title="Re-reading">üîÅ Re-reading</button>
						</div>
					</div>
					<div class="modal-actions-divider"></div>
					<div class="modal-actions-primary">
						<a id="modal-continue-btn" class="btn btn-primary ao3-read-btn" target="_blank">Continue Reading</a>
						<a id="modal-read-btn" class="btn btn-secondary" target="_blank">View on AO3</a>
					</div>
					<div class="modal-actions-secondary">
						<button id="modal-refresh-btn" class="btn btn-icon" title="Refresh metadata from source">
							üîÑ Update
						</button>
						<button id="modal-edit-btn" class="btn btn-icon" title="Edit novel details">
							‚úèÔ∏è Edit
						</button>
						<button id="modal-remove-btn" class="btn btn-icon btn-danger" title="Remove from library">
							üóëÔ∏è Remove
						</button>
					</div>
				</div>
			</div>
		</div>

		<script src="../../../lib/browser-polyfill.min.js"></script>
		<script type="module" src="./shelf-page.js"></script>
	</body>
</html>